######################################################
# sx -> projects.ruppellsgriffon.com - portal server #
######################################################


	proxy_set_header X-Real-IP $remote_addr;
	proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
	proxy_set_header Host $http_host;
	proxy_set_header X-NginX-Proxy true;
	add_header Access-Control-Allow-Origin *.systemapic.com;
	proxy_redirect off;
	proxy_ssl_session_reuse off;

	# limit brute force, ddos
	limit_req_zone $binary_remote_addr zone=one:2000m rate=5000r/s;

	# the IP(s) on which your node server is running. 
	upstream projects.ruppellsgriffon.com {
			server localhost:3001;
	}

	# the nginx server instance
	server {
		listen 443 ssl;
		
		
		server_name  projects.ruppellsgriffon.com;
		access_log   /var/log/nginx/projects.ruppellsgriffon.log;
		error_log    /var/log/nginx/errors.projects.ruppellsgriffon.log;

		
		ssl_session_cache    		shared:SSL:1m;
		ssl_session_timeout  		10m;
		ssl    				on;
		ssl_certificate        		/etc/ssl/projects_ruppellsgriffon_com.pem;
		ssl_certificate_key    		/etc/ssl/projects_ruppellsgriffon_com.key;
		ssl_verify_client 		off;
		

		ssl_protocols             	TLSv1 TLSv1.1 TLSv1.2;
   		ssl_prefer_server_ciphers 	on;
    		ssl_ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-RC4-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA:RC4-SHA:!aNULL:!eNULL:!EXPORT:!DES:!3DES:!MD5:!DSS:!PKS;
  
    		add_header Strict-Transport-Security "max-age=31536000; includeSubdomains;";

		location / {
			proxy_pass http://127.0.0.1:3001;
		}

	}

	#// redirect http requests
	#server {
	#	listen         80;
	#	return 301 https://$host$request_uri;
	#}



